<div class= "backgroundwhite">
<div class="site-container">
  <div class="sidebar">
  <div class="search-product-container">
  <%= form_tag customers_path, method: :get do %>
  <%= label_tag 'Enter your search location:' %>
  <%= text_field_tag 'query[base_location]', @search[:base_location], :value => @customer.base_location %><br>
    <% @categories.each do |category| %>
    <%= check_box_tag 'query[category][]', category.id, @customer.category_ids.include?(category.id) ? true : false %>
    <%= category.name %><br>
    <% end %>
  <%= submit_tag 'Find your sale!', class: "btn btn-primary" %>
  <% end %>
  </div>
    <% @sales.each do |sale| %>
    <%= render partial: "card_product", locals: { sale: sale } %>
    <% end %>
  </div>
  <div class="map-container">
    <div id="map" class="thumbnail" style="width: 100%; height: 100%;"></div>
  </div>
</div>
</div>

<% content_for(:after_js) do %>
 <%= javascript_tag do %>
   $(document).on('ready', function() {
     handler = Gmaps.build('Google');
     handler.buildMap({ internal: { id: 'map' } }, function(){
       markers = handler.addMarkers(<%= raw @markers.to_json %>);
       handler.bounds.extendWith(markers);
       handler.fitMapToBounds();
     });
   })

 <% end %>
<% end %>
